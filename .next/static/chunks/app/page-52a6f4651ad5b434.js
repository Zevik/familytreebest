(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6352:function(e,t,l){Promise.resolve().then(l.bind(l,1036))},1036:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return x}});var a=l(7437),r=l(2265);let n=e=>{let{person:t,onEdit:l,onAddRelative:n}=e,[s,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),c=e=>{n(e),d(!1)};return(0,r.useEffect)(()=>{let e=e=>{e.target.closest(".person-card")||d(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,a.jsxs)("div",{className:"person-card relative bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:t.fullName}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),d(e=>!e)},className:"relative z-20 w-8 h-8 flex items-center justify-center rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors",children:"+"}),(0,a.jsx)("button",{onClick:()=>i(!s),className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-50 text-gray-600 hover:bg-gray-100 transition-colors",children:s?"−":"⋮"})]})]}),o&&(0,a.jsx)("div",{className:"absolute right-0 top-12 w-48 bg-white shadow-xl rounded-lg border border-gray-200 p-2 z-30",onClick:e=>e.stopPropagation(),children:[{type:"parent",label:"הוסף הורה",bgColor:"bg-blue-50",hoverColor:"hover:bg-blue-100"},{type:"sibling",label:"הוסף אח/ות",bgColor:"bg-green-50",hoverColor:"hover:bg-green-100"},{type:"spouse",label:"הוסף בן/בת זוג",bgColor:"bg-purple-50",hoverColor:"hover:bg-purple-100"},{type:"child",label:"הוסף ילד/ה",bgColor:"bg-yellow-50",hoverColor:"hover:bg-yellow-100"}].map(e=>{let{type:t,label:l,bgColor:r,hoverColor:n}=e;return(0,a.jsx)("button",{onClick:()=>c(t),className:"w-full text-right px-4 py-2 mb-1 rounded-md ".concat(r," ").concat(n," transition-colors"),children:l},t)})}),s&&(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,a.jsxs)("p",{children:["תאריך לידה: ",t.birthDateHebrew]}),t.email&&(0,a.jsxs)("p",{children:["אימייל: ",t.email]}),t.phone&&(0,a.jsxs)("p",{children:["טלפון: ",t.phone]}),(0,a.jsxs)("p",{children:["סטטוס: ",{single:"רווק/ה",married:"נשוי/אה",divorced:"גרוש/ה"}[t.marriageStatus]]}),(0,a.jsx)("button",{onClick:l,className:"mt-2 w-full px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"ערוך פרטים"})]})]})};var s=l(5165);let i=e=>{let{people:t,layout:l,onPersonClick:n}=e,i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{var e;if(!i.current||0===t.length)return;s.Ys(i.current).selectAll("*").remove();let a=s.Ys(i.current).attr("width",1e3).attr("height",800).append("g").attr("transform","translate(".concat(500,",50)")),r=function(e){let t=e.find(e=>"zeev-aviner"===e.id);return t?function t(l){let a={id:l.id,name:l.fullName,children:[],data:l},r=e.filter(e=>e.relationships.some(e=>e.relatedPersonId===l.id&&"parent"===e.type));return a.children=r.map(e=>t(e)),a}(t):null}(t);e="vertical"===l?s.G_s().size([900,700]):"horizontal"===l?s.G_s().size([700,900]):s.A4v().force("link",s.Fsl()),"network"===l?function(e,t,l){let a=s.A4v().force("charge",s.q5i().strength(-300)).force("center",s.wqt(0,0)).force("collision",s.Hh().radius(50)),r=function e(t){let l=[t];return t.children&&t.children.forEach(t=>{l.push(...e(t))}),l}(t),n=r.slice(1).map(e=>({source:r.find(t=>t.children&&t.children.some(t=>t===e)),target:e}));a.nodes(r).force("link",s.Fsl(n).distance(100)),e.selectAll("line").data(n).join("line").attr("stroke","#999").attr("stroke-width",1);let i=e.selectAll("g").data(r).join("g").call(s.ohM().on("start",function(e){e.active||a.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y}).on("drag",function(e){e.subject.fx=e.x,e.subject.fy=e.y}).on("end",function(e){e.active||a.alphaTarget(0),e.subject.fx=null,e.subject.fy=null}));i.append("circle").attr("r",5).attr("fill","#4299e1"),i.append("text").attr("x",8).attr("y","0.31em").text(e=>e.name),a.on("tick",()=>{e.selectAll("line").attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),e.selectAll("g").attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")"))})}(a,r,0):function(e,t,l,a,r){let n=s.bT9(t),i=n.links(),o=n.descendants();l(n),e.selectAll("path.link").data(i).join("path").attr("class","link").attr("fill","none").attr("stroke","#999").attr("d",s.rRh().x(e=>a?e.y:e.x).y(e=>a?e.x:e.y));let d=e.selectAll("g.node").data(o).join("g").attr("class","node").attr("transform",e=>a?"translate(".concat(e.y,",").concat(e.x,")"):"translate(".concat(e.x,",").concat(e.y,")")).on("click",(e,t)=>r(t.data.data));d.append("circle").attr("r",5).attr("fill","#4299e1"),d.append("text").attr("dy","0.31em").attr("x",e=>e.children?-6:6).attr("text-anchor",e=>e.children?"end":"start").text(e=>e.data.name).clone(!0).lower().attr("stroke","white").attr("stroke-width",3)}(a,r,e,"horizontal"===l,n)},[t,l]),(0,a.jsx)("div",{className:"w-full overflow-auto",children:(0,a.jsx)("svg",{ref:i,className:"w-full"})})};var o=l(9625),d=l(6885);let c={id:"zeev-aviner",fullName:"זאב אבינר",birthDateHebrew:'כ"ח באייר תש"ם',birthDateGregorian:"1980-05-14",email:"zeev@example.com",phone:"050-1234567",marriageStatus:"married",relationships:[]},p=(0,o.Ue)((0,d.tJ)((e,t)=>({people:[c],addPerson:t=>e(e=>({people:[...e.people,{...t,id:crypto.randomUUID()}]})),updatePerson:(t,l)=>e(e=>({people:e.people.map(e=>e.id===t?{...e,...l}:e)})),addRelationship:(t,l)=>e(e=>({people:e.people.map(e=>e.id===t?{...e,relationships:[...e.relationships,l]}:e)})),calculateRelationships:l=>{let a=t(),r=a.people.find(e=>e.id===l);r&&a.people.forEach(t=>{if(t.id===l)return;let n=calculateIndirectRelations(r,t,a.people);n.length>0&&e(e=>({people:e.people.map(e=>e.id===t.id?{...e,relationships:[...e.relationships,...n]}:e)}))})},addPersonWithRelations:(l,a,r)=>{let n=crypto.randomUUID(),s=t(),i=s.people.find(e=>e.id===a);if(!i)return;let o={...l,id:n,relationships:[{relatedPersonId:a,type:r}]},d=function(e,t,l,a){let r=[];switch(a){case"spouse":findRelatives(t,l,"parent").forEach(e=>{r.push({relatedPersonId:e.id,type:"parent-in-law"})}),findRelatives(t,l,"sibling").forEach(e=>{r.push({relatedPersonId:e.id,type:"sibling-in-law"})});break;case"child":!function(e,t,l,a){let r=l.filter(e=>t.relationships.some(t=>t.relatedPersonId===e.id&&("spouse"===t.type||"ex-spouse"===t.type)))[0]||null;r&&a.push({relatedPersonId:r.id,type:"parent"}),(function(e,t){let l=findParents(e,t);return 0===l.length?[]:t.filter(t=>t.id!==e.id&&l.some(e=>t.relationships.some(t=>t.relatedPersonId===e.id&&"parent"===t.type)))})(t,l).forEach(e=>{a.push({relatedPersonId:e.id,type:"sibling"})}),findParents(t,l).forEach(e=>{a.push({relatedPersonId:e.id,type:"grandparent"})})}(0,t,l,r);break;case"parent":!function(e,t,l,a){let r=l.find(t=>e.relationships.some(e=>e.relatedPersonId===t.id&&"spouse"===e.type))||null;r&&t.relationships.push({relatedPersonId:r.id,type:"parent"}),findChildren(t,l).forEach(e=>{a.push({relatedPersonId:e.id,type:"grandchild"})})}(e,t,l,r);break;case"sibling":findParents(t,l).forEach(e=>{r.push({relatedPersonId:e.id,type:"parent"})}),findChildren(t,l).forEach(e=>{r.push({relatedPersonId:e.id,type:"nephew-niece"})})}return r}(o,i,s.people,r);o.relationships=[...o.relationships,...d],e({people:[...s.people.map(e=>{let t=d.filter(t=>t.relatedPersonId===e.id).map(e=>({relatedPersonId:n,type:({parent:"child",child:"parent",spouse:"spouse",sibling:"sibling","uncle-aunt":"nephew-niece","nephew-niece":"uncle-aunt",cousin:"cousin",grandparent:"grandchild",grandchild:"grandparent","parent-in-law":"child-in-law","child-in-law":"parent-in-law","sibling-in-law":"sibling-in-law","step-parent":"step-child","step-child":"step-parent","step-sibling":"step-sibling","ex-spouse":"ex-spouse"})[e.type]||e.type}));return t.length>0?{...e,relationships:[...e.relationships,...t]}:e}),o]})},syncToStorage:()=>{let e=t();localStorage.setItem("familyTree",JSON.stringify(e.people))},loadFromStorage:()=>{let t=localStorage.getItem("familyTree");t&&e({people:JSON.parse(t)})}}),{name:"family-tree-storage",storage:{getItem:e=>{let t=localStorage.getItem(e);return t?JSON.parse(t):null},setItem:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},removeItem:e=>localStorage.removeItem(e)}}));var u=l(3253);let h=e=>{let{value:t,onChange:l}=e,[n,s]=(0,r.useState)(5784),[i,o]=(0,r.useState)(u.e7.TISHREI),[d,c]=(0,r.useState)(1),p=(e,t,a)=>{let r=new u.Bx(a,t,e),n=r.greg();l(r.toString("h"),"".concat(n.getFullYear(),"-").concat((n.getMonth()+1).toString().padStart(2,"0"),"-").concat(n.getDate().toString().padStart(2,"0")))};return(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("select",{value:d,onChange:e=>{let t=parseInt(e.target.value);c(t),p(n,i,t)},className:"p-2 border rounded",children:Array.from({length:30},(e,t)=>t+1).map(e=>(0,a.jsx)("option",{value:e,children:e},e))}),(0,a.jsx)("select",{value:i,onChange:e=>{let t=parseInt(e.target.value);o(t),p(n,t,d)},className:"p-2 border rounded",children:Object.entries(u.e7).map(e=>{let[t,l]=e;return(0,a.jsx)("option",{value:l,children:t},l)})}),(0,a.jsx)("select",{value:n,onChange:e=>{let t=parseInt(e.target.value);s(t),p(t,i,d)},className:"p-2 border rounded",children:Array.from({length:100},(e,t)=>5784-t).map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})},m=e=>{let{isOpen:t,onClose:l,person:n}=e,[s,i]=(0,r.useState)({...n,deathDateHebrew:n.deathDateHebrew||"",deathDateGregorian:n.deathDateGregorian||""}),o=p(e=>e.updatePerson),d=p(e=>e.addRelationship),c=async e=>{if(e.preventDefault(),"married"===n.marriageStatus&&"divorced"===s.marriageStatus){let e=n.relationships.find(e=>"spouse"===e.type);e&&d(n.id,{relatedPersonId:e.relatedPersonId,type:"ex-spouse"})}await o(n.id,s),l()};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"עריכת פרטי אדם"}),(0,a.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"שם מלא"}),(0,a.jsx)("input",{type:"text",required:!0,value:s.fullName,onChange:e=>i(t=>({...t,fullName:e.target.value})),className:"w-full p-2 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"סטטוס נישואין"}),(0,a.jsxs)("select",{value:s.marriageStatus,onChange:e=>i(t=>({...t,marriageStatus:e.target.value})),className:"w-full p-2 border rounded",children:[(0,a.jsx)("option",{value:"single",children:"רווק/ה"}),(0,a.jsx)("option",{value:"married",children:"נשוי/אה"}),(0,a.jsx)("option",{value:"divorced",children:"גרוש/ה"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["תאריך פטירה",(0,a.jsx)("span",{className:"text-gray-500 text-sm",children:" (אופציונלי)"})]}),(0,a.jsx)(h,{value:s.deathDateHebrew,onChange:(e,t)=>i(l=>({...l,deathDateHebrew:e,deathDateGregorian:t}))})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"ביטול"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"שמור שינויים"})]})]})]})}):null},g=e=>{let{isOpen:t,onClose:l,relatedToId:n,relationType:s}=e,[i,o]=(0,r.useState)({fullName:"",birthDateHebrew:"",birthDateGregorian:"",email:"",phone:"",marriageStatus:"single"}),d=p(e=>e.addPersonWithRelations);return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["הוספת ",{parent:"הורה",child:"ילד/ה",spouse:"בן/בת זוג",sibling:"אח/ות","ex-spouse":"בן/בת זוג לשעבר"}[s]||s]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d(i,n,s),l()},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"שם מלא"}),(0,a.jsx)("input",{type:"text",required:!0,value:i.fullName,onChange:e=>o(t=>({...t,fullName:e.target.value})),className:"w-full p-2 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"תאריך לידה"}),(0,a.jsx)(h,{value:i.birthDateHebrew,onChange:(e,t)=>o(l=>({...l,birthDateHebrew:e,birthDateGregorian:t}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"טלפון"}),(0,a.jsx)("input",{type:"tel",dir:"ltr",value:i.phone,onChange:e=>o(t=>({...t,phone:e.target.value})),className:"w-full p-2 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"אימייל"}),(0,a.jsx)("input",{type:"email",dir:"ltr",value:i.email,onChange:e=>o(t=>({...t,email:e.target.value})),className:"w-full p-2 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"סטטוס נישואין"}),(0,a.jsxs)("select",{value:i.marriageStatus,onChange:e=>o(t=>({...t,marriageStatus:e.target.value})),className:"w-full p-2 border rounded",children:[(0,a.jsx)("option",{value:"single",children:"רווק/ה"}),(0,a.jsx)("option",{value:"married",children:"נשוי/אה"}),(0,a.jsx)("option",{value:"divorced",children:"גרוש/ה"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"ביטול"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"הוסף"})]})]})]})}):null};function x(){let e=p(e=>e.people),[t,l]=(0,r.useState)(null),[s,o]=(0,r.useState)("vertical"),[d,c]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[x,b]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),j=(e,t)=>{b({personId:e,type:t}),h(!0)};return(0,a.jsxs)("main",{className:"min-h-screen p-4 md:p-8",children:[(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("header",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center mb-2",children:"עץ המשפחה שלי"}),(0,a.jsxs)("div",{className:"flex gap-4 justify-center mb-4",children:[(0,a.jsx)("input",{type:"search",placeholder:"חיפוש בן משפחה...",value:d,onChange:e=>c(e.target.value),className:"px-4 py-2 border rounded-lg"}),(0,a.jsxs)("select",{value:s,onChange:e=>o(e.target.value),className:"px-4 py-2 border rounded-lg",children:[(0,a.jsx)("option",{value:"vertical",children:"עץ אנכי"}),(0,a.jsx)("option",{value:"horizontal",children:"עץ אופקי"}),(0,a.jsx)("option",{value:"network",children:"רשת"})]})]})]}),(0,a.jsx)(i,{people:e.filter(e=>!d||e.fullName.includes(d)),layout:s,onPersonClick:e=>l(e.id)}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-8",children:e.map(e=>(0,a.jsx)(n,{person:e,onAddRelative:t=>j(e.id,t),onEdit:()=>v(e)},e.id))})]}),u&&x&&(0,a.jsx)(g,{isOpen:u,onClose:()=>h(!1),relatedToId:x.personId,relationType:x.type}),f&&(0,a.jsx)(m,{isOpen:!!f,onClose:()=>v(null),person:f})]})}}},function(e){e.O(0,[126,91,971,117,744],function(){return e(e.s=6352)}),_N_E=e.O()}]);